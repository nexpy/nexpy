<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Python Graphical User Interface &mdash; NeXpy 0.6.2 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.6.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="NeXpy 0.6.2 documentation" href="index.html" />
    <link rel="next" title="NeXus Tree API Modules" href="treeapi.html" />
    <link rel="prev" title="Python Interface to NeXus" href="pythonshell.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="treeapi.html" title="NeXus Tree API Modules"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pythonshell.html" title="Python Interface to NeXus"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">NeXpy 0.6.2 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Python Graphical User Interface</a><ul>
<li><a class="reference internal" href="#nexpy-menu-bar">NeXpy Menu Bar</a><ul>
<li><a class="reference internal" href="#file-menu">File Menu</a></li>
<li><a class="reference internal" href="#data-menu">Data Menu</a></li>
<li><a class="reference internal" href="#window-menu">Window Menu</a></li>
<li><a class="reference internal" href="#script-menu">Script Menu</a></li>
<li><a class="reference internal" href="#other-menus">Other Menus</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-nexus-data-to-the-tree">Adding NeXus Data to the Tree</a></li>
<li><a class="reference internal" href="#plotting-nexus-data">Plotting NeXus Data</a></li>
<li><a class="reference internal" href="#fitting-nexus-data">Fitting NeXus Data</a><ul>
<li><a class="reference internal" href="#defining-a-function">Defining a function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#importing-nexus-data">Importing NeXus Data</a><ul>
<li><a class="reference internal" href="#existing-readers">Existing Readers</a></li>
<li><a class="reference internal" href="#defining-a-reader">Defining a Reader</a></li>
</ul>
</li>
<li><a class="reference internal" href="#nexpy-plugins">NeXpy Plugins</a></li>
<li><a class="reference internal" href="#configuring-nexpy">Configuring NeXpy</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="pythonshell.html"
                        title="previous chapter">Python Interface to NeXus</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="treeapi.html"
                        title="next chapter">NeXus Tree API Modules</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/pythongui.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="python-graphical-user-interface">
<h1>Python Graphical User Interface<a class="headerlink" href="#python-graphical-user-interface" title="Permalink to this headline">¶</a></h1>
<p>A PyQT GUI has been created to make it easier to keep track of the loaded NeXus
files and the results of any subsequent analysis. It is invoked from the command
line by:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt; nexpy
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This assumes that the Python &#8216;bin&#8217; directory is in your standard shell
path.</p>
</div>
<a class="reference internal image-reference" href="_images/nexpy-gui.png"><img alt="_images/nexpy-gui.png" class="align-center" src="_images/nexpy-gui.png" style="width: 90%;" /></a>
<p>The illustration shows the main features of the GUI:</p>
<dl class="docutils">
<dt><strong>1) Tree Pane</strong></dt>
<dd>This contains the tree structure of NeXus files opened in the File menu,
non-NeXus files that have been imported and converted into the NeXus format
using one of the NeXus readers, and NXroot, NXentry, or NXdata groups added
from the shell. Various actions on the data can be performed by
right-clicking a tree item, include plotting, renaming, fitting and
deleting the data.</dd>
<dt><strong>2) Plot Pane</strong></dt>
<dd>This contains plots produced by (a) the Data:Plot Data menu item, which
operates on the NeXus data selected in the tree, (b) right-clicking on NeXus
data in the tree, or (c) using NeXus data Plot methods from the shell. If an
NXdata, NXmonitor, or NXlog group is plotted, the rank, dimensions, and
plotting axes are determined automatically. If the rank of the data is
greater than two, a two-dimensional slice is extracted from the data. The
GUI allows the selection of alternative slices using one of the axis panels
(see below). If an NXfield is selected, the axes can be chosen from other
NXfields in the same group. It is possible to open other plot windows and
switch between them using the Window menu or keyboard shortcuts (see below).</dd>
<dt><strong>3) Shell Pane</strong></dt>
<dd>This is an iPython shell, with NeXpy already imported (as * so no prefixes
are necessary), along with Numpy (as np) and Pylab (as plt). Any assignments
to items in the tree pane are automatically reflected in the tree pane, and
new NXroot or NXentry objects can be added to the tree from the
iPython shell. NeXus data plots commands from the shell will appear in the
plot pane, and Matplotlib commands can be used to modify the plot
characteristics. The shell has enhanced features such as autocompletion of
NeXus attributes and tooltips containing module docstrings when you open the
module parentheses.</dd>
<dt><strong>4) Axis Panels</strong></dt>
<dd>The tabbed panels below the plot can be used to modify the plots. The
number of panels depends on the rank of the original data. The &#8216;signal&#8217;,
&#8216;x&#8217; and &#8216;y&#8217; panels have text boxes and sliders for adjusting the plotting
limits. For rank two or more, a projection panel allows the plotting of
projections along different directions, using the current axis limits. For
ranks greater than two, a &#8216;z&#8217; panel allows the other dimensions to be
varied. Finally, the &#8216;options&#8217; panel provides access to the standard
Matplotlib tools for modifying the plots.</dd>
<dt><strong>5) Status Bar</strong></dt>
<dd>The values and attributes of the currently selected item in the tree are
displayed in the status bar.</dd>
<dt><strong>6) Tooltips</strong></dt>
<dd>The NeXus tree structure of an item in the tree pane will be displayed as
a tooltip when the cursor hovers over it.</dd>
</dl>
<div class="section" id="nexpy-menu-bar">
<h2>NeXpy Menu Bar<a class="headerlink" href="#nexpy-menu-bar" title="Permalink to this headline">¶</a></h2>
<div class="section" id="file-menu">
<h3>File Menu<a class="headerlink" href="#file-menu" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>New...</strong></dt>
<dd>Creates a new workspace in the tree.</dd>
<dt><strong>Open</strong></dt>
<dd><p class="first">Opens a new NeXus file as read-only. It is possible unlock the file to
allow modifications to the file (see below).</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is possible to open a file in directly read/write mode using
the keyboard shortcut Alt-Shift-O (Cmd-Shift-O on a Mac). Note
that any changes to the file tree, using either the shell or GUI
commands, will be automatically updated in the file.</p>
</div>
</dd>
<dt><strong>Save as...</strong></dt>
<dd><p class="first">Saves the selected tree item to a new NeXus file. If the selected item is
not a NXroot group, it will be wrapped in one to form a valid NeXus file.</p>
<div class="last admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Saving a NeXus object embedded within a tree is not equivalent
to saving the whole tree. Only the object and its children will
be saved to a new file.</p>
</div>
</dd>
<dt><strong>Duplicate...</strong></dt>
<dd>Makes a copy of the NeXus file or tree, leaving the original untouched.
If any field in the original tree is too large to be stored in memory, its
data is stored in an HDF5 memory-mapped file until the tree is saved to a
file.</dd>
<dt><strong>Reload</strong></dt>
<dd>Reloads the NeXus file. This is useful if another application has modified
the data since originally opening the file. This is not currently detected
by NeXpy.</dd>
<dt><strong>Remove</strong></dt>
<dd><p class="first">Removes the root item from the tree.</p>
<div class="last admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This will also remove the item with the same name from the
shell. However, if it had previously been assigned to another
variable with a different name, that variable will not be
deleted.</p>
</div>
</dd>
<dt><strong>Lock file</strong></dt>
<dd>Changes the file access mode to read-only. This will prevent further changes
to the tree using either the GUI or the shell. Locked files are displayed
with a padlock icon.</dd>
<dt><strong>Unlock file</strong></dt>
<dd><p class="first">Changes the file access mode to read/write. If the root tree item has been
saved to a file, any subsequent changes will automatically update the file,
including deleting items.</p>
<div class="last admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Any changes to an unlocked file will be immediate and
irreversible. Make sure you have a backup if your file contains
critical data.</p>
</div>
</dd>
<dt><strong>Import</strong></dt>
<dd><p class="first">Imports data from other formats. Some importers are provided with the NeXpy
distribution, but others will be loaded from the user&#8217;s ~/.nexpy/readers
directory.</p>
<div class="last admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#importing-nexus-data">Importing NeXus Data</a></p>
</div>
</dd>
<dt><strong>Print Shell</strong></dt>
<dd>Prints the contents of the iPython shell.</dd>
</dl>
</div>
<div class="section" id="data-menu">
<h3>Data Menu<a class="headerlink" href="#data-menu" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>Plot Data</strong></dt>
<dd>Plots the selected tree item in the plotting pane. If the selected item is
not a valid NXdata, NXmonitor, or NXlog group, a plot dialog allows the
user to specify axes with compatible dimensions to plot the data against.</dd>
<dt><strong>Overplot Data</strong></dt>
<dd><p class="first">Overplots the selected tree item in the plotting pane. This only works on
one-dimensional data.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The new plot is overlaid on the original plot using the same axis
limits. If some of the new data lies outside the original plotting
limits, the slider limits are increased to cover the expanded
range.</p>
</div>
</dd>
<dt><strong>Plot RGB(A) Image</strong></dt>
<dd>Plots the selected tree item as an RGB(A) image. In such images, the
fastest varying dimension, which should be of size 3 or 4, contains the
RGB(A) values for each pixel. By convention, the first pixel is in the
upper-left corner, rather than the lower-left.</dd>
<dt><strong>Add Data</strong></dt>
<dd><p class="first">Adds data to the selected tree item. If the selected item is a group, the
added data can be a group or field. If the selected item is a field, the
added data must be a field attribute.</p>
<p>When adding a field, the Add Data dialog allows the name, value and data
type to be specified. A dropdown menu can be used to enter field names
that are defined by the NeXus standard, but the user is free to enter
alternative names. The value field can be any valid Python expression,
including numpy functions such as np.linspace().</p>
<p>When adding a group, the Add Data dialog allows the name and class of the
group to be specified. A dropdown menu display can be used to enter one of
the defined NeXus classes. Those above the dashed line are valid in the
context of the selected tree item, but any of the other classes can also be
selected.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you click on the dropdown menus and hover over any item, a
tooltip gives a description of its use.</p>
</div>
</dd>
<dt><strong>Initialize Data</strong></dt>
<dd>Adds a NeXus field to the selected tree item with the specified shape and
data type, but without a predefined value. This is useful when creating
large arrays that have to be entered as slabs. The shape box must contain
a single integer, for a one-dimensional array, or a tuple (or list) of
integers, for a multidimensional array. As with the &#8216;Add Data&#8217; dialog,
dropdown menus show the field names defined by the NeXus standard.</dd>
<dt><strong>Rename Data</strong></dt>
<dd><p class="first">Renames the selected tree item. If the item is a group, its class can also
be changed. Dropdown menus provide a list of valid group classes or field
names defined by the NeXus standard.</p>
<div class="last admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This action will be automatically saved to the NeXus file if
it has been opened as read/write.</p>
</div>
</dd>
<dt><strong>Copy Data</strong></dt>
<dd>Copies the selected tree item to a copy buffer.</dd>
<dt><strong>Paste Data</strong></dt>
<dd>Pastes the copy buffer to the selected group. If the selected group is in a
file open with read/write access, all fields in the copy buffer are copied
to the file. If the selected group is not currently stored in a file and
any field in the copy buffer is too large to be stored in memory, its data
is copied to an HDF5 memory-mapped file using the h5py copy module.</dd>
<dt><strong>Paste As Link</strong></dt>
<dd><p class="first">Pastes a link to the copied node in the selected group. If the copied
node and the selected group have different roots, the copied node is added
to the group as an external link.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">External links can only be modified through the parent file, which
can be opened using the &#8216;Show Link&#8217; menu item (see below).</p>
</div>
<div class="last admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The file containing the external link is referenced using the
file path to the parent file. If the files are moved without
preserving their relative file paths, the link will be broken.</p>
</div>
</dd>
<dt><strong>Delete Data</strong></dt>
<dd><p class="first">Deletes the selected tree item.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the item was assigned to another variable in the shell, that
variable will not be deleted.</p>
</div>
<div class="last admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If the NeXus tree was loaded from a file with read/write
access, the data will be immediately deleted from the file.
This action is irreversible, so ensure you have a backup.</p>
</div>
</dd>
<dt><strong>Show Link</strong></dt>
<dd>Selects the field or group to which the selected item is linked, if it is
an NXlink object, <em>i.e.</em>, shown with a link icon. If the link is external,
the linked file is automatically opened and the linked object is selected.</dd>
<dt><strong>Set Signal</strong></dt>
<dd><p class="first">Sets the plottable signal either to the selected field or to any field
within the selected group. A dialog box allows the user to specify axes with
compatible dimensions to plot the data against.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The use of the &#8216;Add Data&#8217; and &#8216;Set Signal&#8217; menu items allows, in
principle, an entire NeXus data tree to be constructed using menu
calls.</p>
</div>
</dd>
<dt><strong>Fit Data</strong></dt>
<dd><p class="first">Fits the selected tree item. This assumes that the selected item is a valid
NXdata group. The menu item triggers a dialog box, which allows functions
to be chosen and parameters to be initialized before calling a
non-linear least-squares fitting module.</p>
<div class="last admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">See <a class="reference internal" href="#fitting-nexus-data">Fitting NeXus Data</a>.</p>
</div>
</dd>
</dl>
</div>
<div class="section" id="window-menu">
<h3>Window Menu<a class="headerlink" href="#window-menu" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>Show Log File</strong></dt>
<dd><p class="first">Opens a text window displaying the NeXpy log file(s). These files, which are
stored in <code class="docutils literal"><span class="pre">~/.nexpy/nexpy.log</span></code>, <code class="docutils literal"><span class="pre">~/.nexpy/nexpy.log.1</span></code>, <em>etc</em>.,
currently record operations on the tree items, as well as errors in the
IPython shell.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If <a class="reference external" href="https://github.com/ralphbean/ansi2html">ansi2html</a> is
installed, tracebacks will be rendered in color. The log files
contain ANSI markup, which is rendered in the terminal using
<code class="docutils literal"><span class="pre">less</span> <span class="pre">-r</span></code>.</p>
</div>
</dd>
<dt><strong>Change Plot Limits</strong></dt>
<dd><p class="first">This gives a dialog box that allows the axis limits of the currently active
plot to be changed. This is useful if you want to expand the limits beyond
the data values or if you want to narrow the limits to improve the
sensitivity of the sliders.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is equivalent to editing the values in the axis text boxes.</p>
</div>
</dd>
<dt><strong>Reset Plot Limits</strong></dt>
<dd><p class="first">This restores the axis limits to the original values.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Clicking on the Home button in the Options Tab (see below) or
right-clicking within the plot will also restore the original axis
limits.</p>
</div>
</dd>
<dt><strong>Show Projection Panel</strong></dt>
<dd>Show the projection panel for the currently active plotting window. This is
equivalent to clicking on &#8216;Show Panel&#8217; in the projection tab (see below).</dd>
<dt><strong>New Plot Window</strong></dt>
<dd>Opens a new NeXpy plotting window, consisting of a Matplotlib plot pane and
its associated axis panels. NeXpy plot commands will be directed to the
currently active window. Clicking on the plot pane makes it active. All
open windows are listed in the Window menu, along with their labels (&#8216;Main&#8217;,
&#8216;Figure 1&#8217;, &#8216;Figure 2&#8217;, <em>etc</em>.). These are used to switch the focus for
subsequent plots.</dd>
<dt><strong>Main, Figure 1, Figure 2...</strong></dt>
<dd>These menu items set the selected plotting window to be active. As
new windows are created, they are dynamically added to this list.</dd>
</dl>
</div>
<div class="section" id="script-menu">
<h3>Script Menu<a class="headerlink" href="#script-menu" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>New Script</strong></dt>
<dd><p class="first">Opens a new script in an editable text window with syntax coloring. The
Python code can be run within the IPython console at any time using the
console namespace. That means that all the items on the NeXpy tree are also
accessible without further imports.</p>
<p>The scripts can be saved for future use from within NeXpy or from the
terminal command line. They can therefore be formatted as a Python
standalone script to be either run as <code class="docutils literal"><span class="pre">python</span> <span class="pre">script.py</span></code> or run in the
console (similar to the IPython &#8216;run magic&#8217;, <em>i.e.</em>, <code class="docutils literal"><span class="pre">%run</span> <span class="pre">-i</span> <span class="pre">script.py</span></code>).
Script arguments can be entered in a separate text window at the bottom of
the window and accessed within the script in the &#8216;sys.argv&#8217; list.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Script arguments are just text strings, so if the argument is a
node on the tree, it must be referenced as a tree dictionary item,
<em>e.g.</em>, <code class="docutils literal"><span class="pre">nxtree[sys.argv[1]]</span></code></p>
</div>
<p class="last">Scripts are saved, by default, in <code class="docutils literal"><span class="pre">~/.nexpy/scripts</span></code>, and are
automatically added to the bottom of the Script Menu.</p>
</dd>
<dt><strong>Open Script</strong></dt>
<dd>Opens an existing Python script file in an editable text window.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The currently selected node in the NeXpy tree can be referenced in
the script as <code class="docutils literal"><span class="pre">treeview.node</span></code>.</p>
</div>
</div>
<div class="section" id="other-menus">
<h3>Other Menus<a class="headerlink" href="#other-menus" title="Permalink to this headline">¶</a></h3>
<p>The Edit, View, Magic, and Help Menus currently consist of menu items
provided by the iPython shell for their Qt Console. All the operations act on
the shell text.</p>
</div>
</div>
<div class="section" id="adding-nexus-data-to-the-tree">
<h2>Adding NeXus Data to the Tree<a class="headerlink" href="#adding-nexus-data-to-the-tree" title="Permalink to this headline">¶</a></h2>
<p>NXroot groups that are displayed in the tree pane are all children of a group
of class NXtree, known as &#8216;tree&#8217;. If you create a NeXus group dynamically in the
iPython shell, it can be added to the tree pane using the tree&#8217;s add method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">=</span><span class="n">NXroot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">entry</span> <span class="o">=</span> <span class="n">NXentry</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nxtree</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<p>If the group is an NXroot group, it will have the name used in the shell.
If the group is not an NXroot group, the data will be wrapped automatically in
an NXroot group and given a default name that doesn&#8217;t conflict with existing
tree nodes, <em>e.g.</em>, w4.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The NXroot class is still considered to be the root of the NeXus tree
in shell commands. The NXtree group is only used by the GUI and cannot
be saved to a file.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">In python, an object may be accessible within the shell with more
than one name. NeXpy searches the shell dictionary for an object
with the same ID as the added NeXus object and so may choose a
different name. The object in the tree can be renamed.</p>
</div>
</div>
<div class="section" id="plotting-nexus-data">
<h2>Plotting NeXus Data<a class="headerlink" href="#plotting-nexus-data" title="Permalink to this headline">¶</a></h2>
<p>NXdata, NXmonitor, and NXlog data can be plotted by selecting a group on the
tree and choosing &#8220;Plot Data&#8221; from the Data menu or by double-clicking the item
on the tree (or right-clicking for over-plots). Below the plot pane, a series of
tabs allow manipulation of the plot limits and parameters using text boxes
and sliders.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The slider ranges are initially set by the data limits. You can
redefine the slider ranges by editing their respective minimum and/or
maximum text boxes. The original range can be restored by clicking on
the Home button in the Options Tab or right-clicking within the plot.</p>
</div>
<p><strong>Signal Tab</strong></p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/signal-tab.png"><img alt="_images/signal-tab.png" class="align-center" src="_images/signal-tab.png" style="width: 75%;" /></a>
<p>The signal tab contains text boxes and sliders to adjust the intensity
limits, a checkbox to plot the intensity on a log scale, and a dropdown menu
to select a color palette.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For a one-dimensional plot, there is no signal tab. The intensity
is adjusted using the y-tab. There is also no signal tab for an
RGB(A) image, since the colors are defined by the RGB(A) values.</p>
</div>
</div></blockquote>
<p><strong>X/Y Tab</strong></p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/x-tab.png"><img alt="_images/x-tab.png" class="align-center" src="_images/x-tab.png" style="width: 75%;" /></a>
<p>The x and y-tabs contains text boxes and sliders to adjust the axis limits
and a dropdown menu to select the axis to be plotted along x and y,
respectively. The names correspond to the axis names in the NXdata group.
A checkbox allows the direction of the axes to be flipped.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Flipping the axis directions does not flip the direction of the
sliders.</p>
</div>
</div></blockquote>
<p><strong>Z Tab</strong></p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/z-tab.png"><img alt="_images/z-tab.png" class="align-center" src="_images/z-tab.png" style="width: 75%;" /></a>
<p>If the data rank is three or more, the 2D plot <em>vs</em> x and y is a projection
along the remaining axes. The z-tab sets the limits for those projections.
It contains a dropdown menu for selecting the axis to be summed over and
two text boxes for selecting the projection limits. When the data are first
plotted, only the top slice if plotted, <em>i.e.</em>, all the z-axis limits are
set to their minimum value.</p>
<p>When &#8216;Lock&#8217; is checked, the difference between the limits of the selected
z-axis is fixed. This allows successive images along the z-axis to be
plotted by clicking the text-box arrows in increments of the difference
between the two limits. If you use the text-box arrows or the terminal arrow
keys to change the z-limits when they are locked together, the new plot is
updated automatically. Otherwise, the data is only replotted when you force
a replot using the toolbar (see below).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Make sure that the value of both limit boxes is entered, <em>e.g.</em>,
by pressing return after editing their values, before clicking on
the &#8216;lock&#8217; checkbox.</p>
</div>
<p>When stepping through the z-values, the &#8216;Autoscale&#8217; checkbox determines
whether the plot automatically scales the signal to the maximum intensity of
the slice or is set to the current signal limits.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When &#8216;Autoscale&#8217; is checked, it is not possible to adjust the
limits in the Signal Tab.</p>
</div>
<img alt="_images/z-toolbar.png" class="align-right" src="_images/z-toolbar.png" />
<p>The toolbar on the right provides further controls for replotting data as
a function of z. The first button on the left forces a replot, <em>e.g.</em>, when
you have changed z-axis limits or turned on auto-scaling. The other buttons
are for stepping through the z-values automatically, with &#8216;back&#8217;, &#8216;pause&#8217;,
and &#8216;forward&#8217; controls. The default speed is one frame per second, but after
the first click on the play button, subsequent clicks will reduce the frame
interval by a factor two.</p>
</div></blockquote>
<p><strong>Projection Tab</strong></p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/projection-tab.png"><img alt="_images/projection-tab.png" class="align-center" src="_images/projection-tab.png" style="width: 75%;" /></a>
<p>The projection tab allows the data to be projected along one or two
dimensions. The limits are set by the x, y, and z-tabs, while the projection
axes are selected using the dropdown boxes. For a one-dimensional
projection, select &#8216;None&#8217; from the y box. The projections may be plotted in
a separate window, using the &#8216;Plot&#8217; button or saved to a scratch NXdata
group within &#8216;w0&#8217; on the tree. A checkbox allows the overplotting of
one-dimensional projections.</p>
<a class="reference internal image-reference" href="_images/projection.png"><img alt="_images/projection.png" class="align-center" src="_images/projection.png" style="width: 75%;" /></a>
<p>The projection tab also contains a button to open a separate projection
panel. The panel is more convenient when making a systematic exploration of
different projections limits and provides pixel accuracy in computing
projections. The x and y limits of the plot are displayed as a dashed
rectangle, which can be hidden if preferred.</p>
</div></blockquote>
<a class="reference internal image-reference" href="_images/projection-panel.png"><img alt="_images/projection-panel.png" class="align-center" src="_images/projection-panel.png" style="width: 90%;" /></a>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The projection panel can also be used to mask and unmask data within
the dashed rectangle. See <a class="reference internal" href="pythonshell.html"><em>Python Interface to NeXus</em></a> for descriptions of
masked arrays.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Each plotting window can have a separate projection panel in a tabbed
interface.</p>
</div>
<p><strong>Options Tab</strong></p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/options-tab.png"><img alt="_images/options-tab.png" class="align-center" src="_images/options-tab.png" style="width: 90%;" /></a>
<p>The options tab provides the standard Matplotlib toolbar. You can view with the addition
of one extra button. From left to right, the buttons are:</p>
<ul class="simple">
<li><strong>Home</strong> - restores all plotting limits to their original values.</li>
<li><strong>Arrows</strong> - cycles through the limits of previous plots.</li>
<li><strong>Pan</strong> - enables panning mode (disabling zoom mode).</li>
<li><strong>Zoom</strong> - enables zoom mode (disabling pan mode).</li>
<li><strong>Aspect</strong> - toggles between setting the aspect ratio automatically
to fill the available space or setting the x and y scales to be equal.
This is only valid if the units of the x and y axes are identical.</li>
<li><strong>Subplot</strong> - configures the spacing around the plot.</li>
<li><strong>Save</strong> - saves plot to PNG file.</li>
<li><strong>Add</strong> - adds plotted data to the tree pane as an NXdata group within the
scratch workspace &#8216;w0&#8217;.</li>
<li><strong>Edit</strong> - allows marker and line formatting to be modified.</li>
</ul>
<p>On the far right of the toolbar, the data and axis values are dynamically
updated to the values under the current mouse location.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">See the <a class="reference external" href="http://matplotlib.org/users/navigation_toolbar.html">Matplotlib documentation</a> for
more detailed descriptions of the standard toolbar, including
keyboard shortcuts. The &#8216;Aspect&#8217; and &#8216;Add&#8217; buttons are unique
to NeXpy.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The aspect ratio of a plot can also be set from the IPython shell.
See below.</p>
</div>
</div></blockquote>
<p><strong>Command Line Options</strong></p>
<blockquote>
<div><p>It is possible to modify some of the plotting features from the IPython
shell. The current plotting pane, the default Matplotlib axis instance, and
the current image are exposed as <code class="docutils literal"><span class="pre">plotview</span></code>, <code class="docutils literal"><span class="pre">plotview.ax</span></code>, and
<code class="docutils literal"><span class="pre">plotview.image</span></code>, respectively.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Before making any changes, make sure that you have selected the
right plotting pane, either by selecting it in the Window menu or
using one of the keyboard shortcuts, which are displayed in the
menu, <em>e.g.</em>, &lt;Ctrl&gt;+2 (⌘+2 on a Mac) to select Figure 2.</p>
</div>
</div></blockquote>
<ul>
<li><p class="first">Set Aspect Ratio:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">plotview</span><span class="o">.</span><span class="n">aspect</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">aspect</span><span class="o">&gt;</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">&lt;aspect&gt;</span></code> can be any of the values allowed by the <a class="reference external" href="http://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes.set_aspect">Matplotlib set_aspect</a>
function, <em>i.e.</em>, &#8216;auto&#8217;, &#8216;equal&#8217;, or the numerical value of the
ratio between the height and the width (if the units are identical). The
&#8216;Aspect&#8217; button (see above) toggles between &#8216;auto&#8217; and &#8216;equal&#8217;.</p>
</li>
<li><p class="first">Set Offsets:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">plotview</span><span class="o">.</span><span class="n">offsets</span> <span class="o">=</span> <span class="o">&lt;</span><span class="bp">True</span><span class="o">|</span><span class="bp">False</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>If the range of an axis is much smaller than the absolute values, the axis
labels can overlap. Setting this option will determine whether Matplotlib
converts the axis labels to differences from a fixed offset value or not.
The default is <code class="docutils literal"><span class="pre">False</span></code>.</p>
</li>
<li><p class="first">Select Color Map:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">plotview</span><span class="o">.</span><span class="n">cmap</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">cmap</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This allows the color map of the currently displayed image to be changed.
This can be useful if the map is not available in the Signal Tab. See the
<a class="reference external" href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.set_cmap">Matplotlib documentation</a>
for more details.</p>
</li>
<li><p class="first">Draw Shapes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">plotview</span><span class="o">.</span><span class="n">vline</span><span class="p">(</span><span class="o">&lt;</span><span class="n">x</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">ymin</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">ymax</span><span class="o">&gt;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plotview</span><span class="o">.</span><span class="n">hline</span><span class="p">(</span><span class="o">&lt;</span><span class="n">y</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">xmin</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">xmax</span><span class="o">&gt;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plotview</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="o">&lt;</span><span class="n">x</span><span class="o">-</span><span class="n">array</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">ymin</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">ymax</span><span class="o">&gt;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plotview</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="o">&lt;</span><span class="n">y</span><span class="o">-</span><span class="n">array</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">xmin</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">xmax</span><span class="o">&gt;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plotview</span><span class="o">.</span><span class="n">crosshairs</span><span class="p">(</span><span class="o">&lt;</span><span class="n">x</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">y</span><span class="o">&gt;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plotview</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="o">&lt;</span><span class="n">x</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">y</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">dx</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">dy</span><span class="o">&gt;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plotview</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="o">&lt;</span><span class="n">x</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">y</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">radius</span><span class="o">&gt;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plotview</span><span class="o">.</span><span class="n">ellipse</span><span class="p">(</span><span class="o">&lt;</span><span class="n">x</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">y</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">dx</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">dy</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>
</div>
<p>These functions draw graphical primitives on the plot using the axis
coordinates. In the case of the lines, the complete range of the plot will
be used if the minimum and maximum values are omitted. The rectangle
coordinates represent the lower left-hand corner but the circle and ellipse
coordinates represent the shape center.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since the arguments are in the units of the axes, the circle will
only be truly circular if the x and y units are the same, and the
aspect ratio of the plot is equal.</p>
</div>
<p>All of the functions will accept additional keyword arguments used in
drawing Matplotlib shapes, <em>e.g.</em>, to change the edge and fill colors, line
properties, <em>etc</em>. See the <a class="reference external" href="http://matplotlib.org/api/patches_api.html#matplotlib.patches.Polygon">Matplotlib documentation</a>
for more details.</p>
</li>
</ul>
</div>
<div class="section" id="fitting-nexus-data">
<h2>Fitting NeXus Data<a class="headerlink" href="#fitting-nexus-data" title="Permalink to this headline">¶</a></h2>
<p>It is possible to fit one-dimensional data using the non-linear least-squares
fitting package, <a class="reference external" href="http://newville.github.io/lmfit-py">lmfit-py</a>, by selecting
a group on the tree and choosing &#8220;Fit Data&#8221; from the Data menu or by
right-clicking on the group. This opens a dialog window that allows multiple
functions to be combined, with the option of fixing or limiting parameters.</p>
<a class="reference internal image-reference" href="_images/nexpy-fits.png"><img alt="_images/nexpy-fits.png" class="align-center" src="_images/nexpy-fits.png" style="width: 90%;" /></a>
<p>The fit can be plotted, along with the constituent functions, in the main
plotting window and the fitting parameters displayed in a message window.</p>
<p>The original data, the fitted data, constituent functions, and the parameters
can all be saved to an NXentry group in the Tree Pane for subsequent plotting,
refitting, or saving to a NeXus file. The group is an NXentry group, with name
&#8216;f1&#8217;, &#8216;f2&#8217;, etc., stored in the default scratch NXroot group, w0. If you choose
to fit this entry again, it will load the functions and parameters from the
saved fit.</p>
<div class="section" id="defining-a-function">
<h3>Defining a function<a class="headerlink" href="#defining-a-function" title="Permalink to this headline">¶</a></h3>
<p>User-defined functions can be added to their private functions directory in
<code class="docutils literal"><span class="pre">~/.nexpy/functions</span></code>. The file must define the name of the function, a list of
parameter names, and provide two modules to return the function values and
starting parameters, respectively.</p>
<p>As an example, here is the complete Gaussian function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">function_name</span> <span class="o">=</span> <span class="s">&#39;Gaussian&#39;</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Integral&#39;</span><span class="p">,</span> <span class="s">&#39;Sigma&#39;</span><span class="p">,</span> <span class="s">&#39;Center&#39;</span><span class="p">]</span>

<span class="n">factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="n">integral</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">center</span> <span class="o">=</span> <span class="n">p</span>
    <span class="k">return</span> <span class="n">integral</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">center</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">sigma</span> <span class="o">*</span> <span class="n">factor</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">guess</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">y</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(((</span><span class="n">x</span><span class="o">-</span><span class="n">center</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">y</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
    <span class="n">integral</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">factor</span>
    <span class="k">return</span> <span class="n">integral</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">center</span>
</pre></div>
</div>
<p>NeXpy uses the function&#8217;s &#8216;guess&#8217; module to produce starting parameters
automatically when the function is loaded. When each function is added to the
model, the estimated y-values produced by that function will be subtracted from
the data before the next function estimate. It is useful therefore to choose the
order of adding functions carefully. For example, if a peak is sitting on a
sloping background, the background function should be loaded first since it is
estimated from the first and last data points. This guess will be subtracted
before estimating the peak parameters. Obviously, the more functions that are
added, the less reliable the guesses will be. Starting parameters will have to
be entered manually before the fit in those cases.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If it is not possible to estimate starting parameters, just return
values that do not trigger an exception.</p>
</div>
</div>
</div>
<div class="section" id="importing-nexus-data">
<h2>Importing NeXus Data<a class="headerlink" href="#importing-nexus-data" title="Permalink to this headline">¶</a></h2>
<p>NeXpy can import data stored in a number of other formats, including SPEC files,
TIFF images, and text files, using the <a class="reference external" href="File:Import">File:Import</a> menus. If a file format is
not currently supported, the user can write their own. The following is an
example of a module that reads the original format and returns NeXus data:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">libtiff</span> <span class="kn">import</span> <span class="n">TIFF</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">TIFF</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">read_image</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">NXentry</span><span class="p">(</span><span class="n">NXdata</span><span class="p">(</span><span class="n">z</span><span class="p">,(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)))</span>
</pre></div>
</div>
<p>This could be run in the shell pane and then added to the tree using:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">nxtree</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">get_data</span><span class="p">(</span><span class="s">&#39;image.tif&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="section" id="existing-readers">
<h3>Existing Readers<a class="headerlink" href="#existing-readers" title="Permalink to this headline">¶</a></h3>
<p>NeXpy is currently distributed with readers for the following format:</p>
<p><strong>TIFF Images</strong></p>
<p>This reader will import most TIFF images, including those with floating
point pixels.</p>
<p><strong>CBF Files</strong></p>
<p>This reader will read files stored in the <a class="reference external" href="http://www.iucr.org/resources/cif/software/cbflib">Crystallographic Binary Format</a>, using the PyCBF library.
Header information is stored in a NXnote.</p>
<p><strong>Image Stack</strong></p>
<p>This reader will read a stack of images, currently either TIFF or CBF, into a
three-dimensional NXdata group. The image stack must be stored in separate files
in a single directory, that are grouped with a common prefix followed by an
integer defining the stack sequence.</p>
<p><strong>Text Files</strong></p>
<p>This reader will read ASCII data stored in two or three columns, containing the
x and y values, and, optionally, errors. One or more header lines can be skipped.
A more flexible text importer, allowing the selection of data from multiple
columns, is under development.</p>
<p><strong>SPEC Files</strong></p>
<p>This reader will read multiple SPEC scans from a single SPEC log file, creating
a separate NXentry for each scan. All the columns in each scan are read into
the NXdata group, with the default signal defined by the last column. Mesh scans
are converted to multi-dimensional data, with axes defined by the scan command.
It is possible to plot different columns once the scans are imported.</p>
<p><strong>SPE/NXSPE Files</strong></p>
<p>This will read both the ASCII and binary (HDF5) versions of the neutron
time-of-flight SPE intermediate format into standard-conforming NeXus files.
The data is stored as S(phi,E), but, if the incident energy and (Q,E) bins are
also defined, the data will will also be converted into S(Q,E). The current
version does not read the ASCII PHX files used to define instrumental
parameters, but there are plans to add that in the future.</p>
</div>
<div class="section" id="defining-a-reader">
<h3>Defining a Reader<a class="headerlink" href="#defining-a-reader" title="Permalink to this headline">¶</a></h3>
<p>With a little knowledge of PyQt, it is possible to add a reader to the
<a class="reference external" href="File:Import">File:Import</a> menu using the existing samples as a guide in the nexpy.readers
directory. User-defined import dialogs can be added to their private readers
directory in <code class="docutils literal"><span class="pre">~/.nexpy/readers</span></code>.</p>
<p>Here is an example of an import dialog:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module to read in a TIFF file and convert it to NeXus.</span>

<span class="sd">Each importer needs to layout the GUI buttons necessary for defining the</span>
<span class="sd">imported file and its attributes and a single module, get_data, which returns</span>
<span class="sd">an NXroot or NXentry object. This will be added to the NeXpy tree.</span>

<span class="sd">Two GUI elements are provided for convenience:</span>

<span class="sd">    ImportDialog.filebox: Contains a &quot;Choose File&quot; button and a text box. Both</span>
<span class="sd">                          can be used to set the path to the imported file.</span>
<span class="sd">                          This can be retrieved as a string using</span>
<span class="sd">                          self.get_filename().</span>
<span class="sd">    ImportDialog.close_buttons: Contains a &quot;Cancel&quot; and &quot;OK&quot; button to close</span>
<span class="sd">                                the dialog. This should be placed at the bottom</span>
<span class="sd">                                of all import dialogs.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">PySide</span> <span class="kn">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">nexusformat.nexus</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">nexpy.gui.importdialog</span> <span class="kn">import</span> <span class="n">BaseImportDialog</span>

<span class="n">filetype</span> <span class="o">=</span> <span class="s">&quot;TIFF Image&quot;</span> <span class="c">#Defines the Import Menu label</span>

<span class="k">class</span> <span class="nc">ImportDialog</span><span class="p">(</span><span class="n">BaseImportDialog</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Dialog to import a TIFF image&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">ImportDialog</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>

        <span class="n">layout</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filebox</span><span class="p">())</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close_buttons</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s">&quot;Import &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">filetype</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">libtiff</span> <span class="kn">import</span> <span class="n">TIFF</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">TIFF</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_filename</span><span class="p">())</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">NXfield</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">read_image</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;z&#39;</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">NXfield</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;y&#39;</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">NXfield</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">NXentry</span><span class="p">(</span><span class="n">NXdata</span><span class="p">(</span><span class="n">z</span><span class="p">,(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)))</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">See <a class="reference internal" href="importdialog.html#nexpy.gui.importdialog.BaseImportDialog" title="nexpy.gui.importdialog.BaseImportDialog"><code class="xref py py-class docutils literal"><span class="pre">nexpy.gui.importdialog.BaseImportDialog</span></code></a> and its parent
<code class="xref py py-class docutils literal"><span class="pre">nexpy.gui.importdialog.BaseDialog</span></code> for other
pre-defined methods.</p>
</div>
</div>
</div>
<div class="section" id="nexpy-plugins">
<h2>NeXpy Plugins<a class="headerlink" href="#nexpy-plugins" title="Permalink to this headline">¶</a></h2>
<p>It is possible to customize NeXpy by adding new menus to the main menu bar
with sub-menus that open dialog boxes for operations that are specific to a
particular domain. These will be automatically loaded from either the
<code class="docutils literal"><span class="pre">nexpy.plugins</span></code> directory within the installed NeXpy distribution or from the
users&#8217; <code class="docutils literal"><span class="pre">~/.nexpy/plugins</span></code> directory.</p>
<p>The new menu should be defined as a Python package, <em>i.e.</em>, by creating a
sub-directory within the plugins directory that contains <code class="docutils literal"><span class="pre">__init__.py</span></code> to
define the menu actions.</p>
<p>There is an example package, <code class="docutils literal"><span class="pre">chopper</span></code>, in the <code class="docutils literal"><span class="pre">nexpy.examples</span></code> directory,
to show how plugins can work. It adds a top-level menu item, <code class="docutils literal"><span class="pre">chopper</span></code>, that
has a couple of menu items to perform data analysis on the example file,
<code class="docutils literal"><span class="pre">chopper.nxs</span></code>, which is distributed with NeXpy.</p>
<p>Here is the <code class="docutils literal"><span class="pre">__init__.py</span></code> file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">get_ei</span><span class="o">,</span> <span class="nn">convert_qe</span>

<span class="k">def</span> <span class="nf">plugin_menu</span><span class="p">():</span>
    <span class="n">menu</span> <span class="o">=</span> <span class="s">&#39;Chopper&#39;</span>
    <span class="n">actions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&#39;Get Incident Energy&#39;</span><span class="p">,</span> <span class="n">get_ei</span><span class="o">.</span><span class="n">show_dialog</span><span class="p">))</span>
    <span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&#39;Convert to Q-E&#39;</span><span class="p">,</span> <span class="n">convert_qe</span><span class="o">.</span><span class="n">show_dialog</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">menu</span><span class="p">,</span> <span class="n">actions</span>
</pre></div>
</div>
<p>The actions define the menu text and the function that gets called when it
is selected. In the example, they are contained within the package as two files,
<code class="docutils literal"><span class="pre">get_ei.py</span></code> and <code class="docutils literal"><span class="pre">convert_qe.py</span></code>, but they could also be in a separately
installed package in the Python path.</p>
<p>These files should open a dialog box and perform the required operations, after
which the results can either be saved to a new NeXus file or saved as
modifications to an existing tree item.</p>
<p>For example, <code class="docutils literal"><span class="pre">get_ei.py</span></code> reads the monitor spectra contained within the
currently selected node on the tree, which should have been previously loaded.
It then calculates the difference between the peak positions of the two spectra,
calculates the incident energy, which is updated in both the dialog box and, if
the <code class="docutils literal"><span class="pre">Save</span></code> button is pressed, in the loaded NeXus tree, ready for subsequent
analysis.</p>
<p>In the simplest cases, no knowledge of PyQt is required. In the example below,
a grid defines a set of parameters, functions to read those parameters from
the PySide text boxes (here, they are decorated with <code class="docutils literal"><span class="pre">&#64;property</span></code>, which
means that the function can be called without an argument), a couple of
buttons to activate different parts of the analysis, and finally the
functions themselves.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">See <a class="reference internal" href="importdialog.html#nexpy.gui.datadialogs.BaseDialog" title="nexpy.gui.datadialogs.BaseDialog"><code class="xref py py-class docutils literal"><span class="pre">nexpy.gui.datadialogs.BaseDialog</span></code></a> for a list of
pre-defined dialog methods if the dialog uses it as the parent
class.</p>
</div>
<p>Here is the code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">nexpy.gui.pyqt</span> <span class="kn">import</span> <span class="n">QtGui</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">nexpy.gui.datadialogs</span> <span class="kn">import</span> <span class="n">BaseDialog</span><span class="p">,</span> <span class="n">GridParameters</span>
<span class="kn">from</span> <span class="nn">nexpy.gui.mainwindow</span> <span class="kn">import</span> <span class="n">report_error</span>
<span class="kn">from</span> <span class="nn">nexusformat.nexus</span> <span class="kn">import</span> <span class="n">NeXusError</span>


<span class="k">def</span> <span class="nf">show_dialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">EnergyDialog</span><span class="p">()</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">NeXusError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="n">report_error</span><span class="p">(</span><span class="s">&quot;Getting Incident Energy&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">EnergyDialog</span><span class="p">(</span><span class="n">BaseDialog</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">EnergyDialog</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">select_entry</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="n">GridParameters</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;m1&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="p">[</span><span class="s">&#39;monitor1/distance&#39;</span><span class="p">],</span>
                            <span class="s">&#39;Monitor 1 Distance&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;m2&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="p">[</span><span class="s">&#39;monitor2/distance&#39;</span><span class="p">],</span>
                            <span class="s">&#39;Monitor 2 Distance&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;Ei&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="p">[</span><span class="s">&#39;instrument/monochromator/energy&#39;</span><span class="p">],</span>
                            <span class="s">&#39;Incident Energy&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;mod&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="p">[</span><span class="s">&#39;instrument/source/distance&#39;</span><span class="p">],</span>
                            <span class="s">&#39;Moderator Distance&#39;</span><span class="p">)</span>
        <span class="n">action_buttons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_buttons</span><span class="p">((</span><span class="s">&#39;Get Ei&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ei</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_layout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry_layout</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">grid</span><span class="p">(),</span>
                        <span class="n">action_buttons</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">close_buttons</span><span class="p">(</span><span class="n">save</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Get Incident Energy&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="p">[</span><span class="s">&#39;monitor1&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="p">[</span><span class="s">&#39;monitor2&#39;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">m1_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s">&#39;m1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">moderator_distance</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">m2_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s">&#39;m2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">moderator_distance</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Ei</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s">&#39;Ei&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">moderator_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s">&#39;mod&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>

    <span class="k">def</span> <span class="nf">get_ei</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="mf">2286.26</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">m1_distance</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ei</span><span class="p">)</span>
        <span class="n">m1_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m1</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mf">200.0</span><span class="p">:</span><span class="n">t</span><span class="o">+</span><span class="mf">200.0</span><span class="p">]</span><span class="o">.</span><span class="n">moment</span><span class="p">()</span>
        <span class="n">t</span> <span class="o">=</span> <span class="mf">2286.26</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">m2_distance</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ei</span><span class="p">)</span>
        <span class="n">m2_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m2</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mf">200.0</span><span class="p">:</span><span class="n">t</span><span class="o">+</span><span class="mf">200.0</span><span class="p">]</span><span class="o">.</span><span class="n">moment</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s">&#39;Ei&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2286.26</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m2_distance</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">m1_distance</span><span class="p">)</span> <span class="o">/</span>
                                       <span class="p">(</span><span class="n">m2_time</span> <span class="o">-</span> <span class="n">m1_time</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>

    <span class="k">def</span> <span class="nf">accept</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s">&#39;Ei&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">NeXusError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">report_error</span><span class="p">(</span><span class="s">&quot;Getting Incident Energy&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">EnergyDialog</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="configuring-nexpy">
<h2>Configuring NeXpy<a class="headerlink" href="#configuring-nexpy" title="Permalink to this headline">¶</a></h2>
<p>The NeXpy shell imports the following NeXus classes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">nexpy</span>
<span class="kn">import</span> <span class="nn">nexusformat.nexus</span> <span class="kn">as</span> <span class="nn">nx</span>
<span class="kn">from</span> <span class="nn">nexusformat.nexus</span> <span class="kn">import</span> <span class="n">NXFile</span><span class="p">,</span> <span class="n">NXgroup</span><span class="p">,</span> <span class="n">NXfield</span><span class="p">,</span> <span class="n">NXattr</span><span class="p">,</span> <span class="n">NXlink</span>
</pre></div>
</div>
<p>along with all the currently defined NeXus group classes (NXentry, NXdata,
NXsample, <em>etc</em>).</p>
<p>For convenience, the NeXpy shell also imports a number of other modules that are
commonly used:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">h5py</span> <span class="kn">as</span> <span class="nn">h5</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">numpy.ma</span> <span class="kn">as</span> <span class="nn">ma</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="kn">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="kn">as</span> <span class="nn">mpl</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pylab</span><span class="p">,</span> <span class="n">mlab</span><span class="p">,</span> <span class="n">pyplot</span>
<span class="n">plt</span> <span class="o">=</span> <span class="n">pyplot</span>
</pre></div>
</div>
<p>If you require a different set of imports or prefer alternative abbreviations,
you can replace the default startup script with your own by placing the
required code in ~/.nexpy/config.py.</p>
<p>The console can be configured using the <a class="reference external" href="http://ipython.org/ipython-doc/stable/interactive/tutorial.html#configuration">IPython configuration system</a>.
For example, if you don&#8217;t want a blank line between each input line, edit
~/.ipython/profile_default/ipython_qtconsole_config.py and set:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">c</span><span class="o">.</span><span class="n">IPythonWidget</span><span class="o">.</span><span class="n">input_sep</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="treeapi.html" title="NeXus Tree API Modules"
             >next</a> |</li>
        <li class="right" >
          <a href="pythonshell.html" title="Python Interface to NeXus"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">NeXpy 0.6.2 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2013-2015, Ray Osborn.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>